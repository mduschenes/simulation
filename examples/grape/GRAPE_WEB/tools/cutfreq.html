
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
     <title>Filename : cutfreq</title>
      <meta name="generator" content="MATLAB 7.14">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2014-03-05">
      <meta name="DC.source" content="cutfreq.m">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <link rel="stylesheet" type="text/css" href="../css/screen.css" media="screen" />
  </head>
  
<body>
    <ul id=menu>
      <li><a href="../flowchart.html">Flow Chart</a>
      <li><a href="../tools/tools.html">Tools</a>
      <li><a href="../faq/faq.html">F. A. Q.</a>
      <li><a href="../../index.html">NMR-QIP Page</a>
    </ul>
    
    
    <div class="content"><h1>FileName : cutfreq</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#2">Command</a></li><li><a href="#3">Example</a></li></ul></div><h2>Description<a name="1"></a></h2><p>Cuts the higher order frequency from a GRAPE pulse to make it more smooth. We take the fourier transform of the controls and neglect the higher frequencies as per input in per, then do the inverse fourier transform to get the new controls.</p><h2>Command<a name="2"></a></h2><p><b>new_u=cutfreq(GRinfo,per)</b></p><p><b>GRinfo</b> : Variable in which all the information of grape pulse is stored.</p><p><b>per</b> : percentage of high frequency components you want to truncate</p><h2>Example<a name="3"></a></h2><p>Shown below is an example.</p><p><img vspace="5" hspace="5" src="../tools/img/sample_cutfreq.jpg" alt=""> </p><pre class="codeinput"><span class="keyword">function</span> trunc_unew = cutfreq(GRinfo,per)
<span class="keyword">global</span> gra
gra=GRinfo;

<span class="keyword">if</span>(per&gt;50) ; error(<span class="string">'Percentage is more than 50 % all entries will be zeros'</span>); <span class="keyword">end</span>

unew = gra.u;

funew = fftshift(fft(unew));
num2cut = round(length(funew)*per/100);

<span class="keyword">for</span> j=1:gra.m
    funew(1:num2cut,j) = 0;
    funew(length(funew)-num2cut:end,j)=0;
<span class="keyword">end</span>
ifunew = ifft(ifftshift(funew));

trunc_unew = real(ifunew);
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% FileName : cutfreq

%% Description
% Cuts the higher order frequency from a GRAPE pulse to make it more
% smooth. We take the fourier transform of the controls and neglect the
% higher frequencies as per input in per, then do the inverse fourier
% transform to get the new controls.

%% Command
% *new_u=cutfreq(GRinfo,per)*
%
% *GRinfo* : Variable in which all the information of grape pulse is stored.
%
% *per* : percentage of high frequency components you want to truncate 
%

%% Example
% Shown below is an example.
%
% <<sample_cutfreq.jpg>>
%

function trunc_unew = cutfreq(GRinfo,per)

if nargin<1
    disp('  ')
    disp('      trunc_unew = cutfreq(GRinfo,per)')
    disp('      Truncates the higher frequency terms')
    disp('  ')
    disp('                      per - percentage of high frequency components to truncate')
    disp('  ')
    disp('      SIMPLEST INPUT : trunc_unew = cutfreq(GRinfo,per)')
    disp('  ')
    disp('  ')
    disp('  ')
    disp('   (Hemant Katiyar, 2012)')
    return
end

global gra
gra=GRinfo;

if(per>50) ; error('Percentage is more than 50 % all entries will be zeros'); end

unew = gra.u;

funew = fftshift(fft(unew));
num2cut = round(length(funew)*per/100);

for j=1:gra.m
    funew(1:num2cut,j) = 0;
    funew(length(funew)-num2cut:end,j)=0;
end
ifunew = ifft(ifftshift(funew));

trunc_unew = real(ifunew);
##### SOURCE END #####
--></body></html>