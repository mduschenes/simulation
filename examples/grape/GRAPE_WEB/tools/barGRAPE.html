
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <title>Filename : barGRAPE</title>
      <meta name="generator" content="MATLAB 7.14">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2014-03-05">
      <meta name="DC.source" content="barGRAPE.m">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <link rel="stylesheet" type="text/css" href="../css/screen.css" media="screen" />
  </head>
  
<body>
    <ul id=menu>
      <li><a href="../flowchart.html">Flow Chart</a>
      <li><a href="../tools/tools.html">Tools</a>
      <li><a href="../faq/faq.html">F. A. Q.</a>
      <li><a href="../../index.html">NMR-QIP Page</a>
    </ul>
    <div class="content"><h1>FileName : barGRAPE</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#2">Command</a></li><li><a href="#3">Example Output</a></li></ul></div><h2>Description<a name="1"></a></h2><p>Plots separate plots for the Real and Imaginary part of a density matrix, after the application of both theroretical operator and GRAPE simulated operator.</p><h2>Command<a name="2"></a></h2><p><b>barGRAPE(GRinfo,indm)</b></p><p><b>GRinfo</b> : Variable in which all the information of grape pulse is stored.</p><p><b>indm</b> : Initial density matrix on which the pulse will be applied, by default it is the thermal equilibrium density matrix of NMR system.</p><h2>Example Output<a name="3"></a></h2><p>Shown below is an example plot. Red is ux and green is uy.</p><p><img vspace="5" hspace="5" src="../tools/img/sample_barGRAPE.jpg" alt=""> </p><pre class="codeinput"><span class="keyword">function</span> barGRAPE(GRinfo,indm)
 <span class="keyword">global</span> gra
 gra=GRinfo;
 [~,~,Iz,~,~,~,sIHz] = prodop(gra.spinNumbers,gra.spinlist);

 <span class="comment">%-------Declaring Default Inputs--------------------</span>
<span class="keyword">if</span> (nargin &lt; 2 || isempty(indm)); indm=sum(Iz,3); <span class="keyword">end</span>;

<span class="comment">%-----------------------------------------------------</span>
outdm_sim = gra.Usim*indm*(gra.Usim)';
outdm_th  = gra.Utarg*indm*(gra.Utarg)';

<span class="comment">%--------PLOTTING------------------------------</span>
figure
subplot(2,2,1),bar3(real(outdm_th));
t1a=title(<span class="string">'Ideal (Real)'</span>);
set(gca,<span class="string">'FontSize'</span>,10,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>)
subplot(2,2,2),bar3(imag(outdm_th));
t2a=title(<span class="string">'Ideal (Imag)'</span>);
set(gca,<span class="string">'FontSize'</span>,10,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>)

subplot(2,2,3),bar3(real(outdm_sim));
t1=title(<span class="string">'Simu. (Real)'</span>);
set(gca,<span class="string">'FontSize'</span>,10,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>)
subplot(2,2,4),bar3(imag(outdm_sim));
t2=title(<span class="string">'Sim. (Imag)'</span>);
set(gca,<span class="string">'FontSize'</span>,10,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>)
set([t1 t1a t2 t2a],<span class="string">'FontSize'</span>,12,<span class="string">'FontWeight'</span>,<span class="string">'bold'</span>)
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% FileName : barGRAPE

%% Description
% Plots separate plots for the Real and Imaginary part of a density matrix, after the
% application of both theroretical operator and GRAPE simulated operator.


%% Command
% *barGRAPE(GRinfo,indm)*
%
% *GRinfo* : Variable in which all the information of grape pulse is stored.
%
% *indm* : Initial density matrix on which the pulse will be applied, by
% default it is the thermal equilibrium density matrix of NMR system.
%

%% Example Output
% Shown below is an example plot. Red is ux and green is uy.
%
% <<sample_barGRAPE.jpg>>



function barGRAPE(GRinfo,indm)

if nargin<1
    disp('  ')
    disp('      barGRAPE(GRinfo,initialdm)')
    disp('      Plots 3D barplot for the simulated gate')
    disp('      applied on some density matrix given by initialdm')
    disp('  ')
    disp('          initialdm - Initial Density Matrix')
    disp('                      {default: Equilibrium Density matrix taken}')
    disp('  ')
    disp('      SIMPLEST INPUT : barGRAPE(GRinfo)')
    disp('  ')
    disp('   It is unnecessary to provide all the inputs.  Empty inputs indicate')
    disp('   indicate default selections.')
    disp('  ')
    disp('   (Hemant Katiyar, 2012)')
    return
end
 
 
 global gra
 gra=GRinfo; 
 [~,~,Iz,~,~,~,sIHz] = prodop(gra.spinNumbers,gra.spinlist);

 %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Declaring Default InputsREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
if (nargin < 2 || isempty(indm)); indm=sum(Iz,3); end;

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
outdm_sim = gra.Usim*indm*(gra.Usim)';
outdm_th  = gra.Utarg*indm*(gra.Utarg)';

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHPLOTTINGREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
figure
subplot(2,2,1),bar3(real(outdm_th));
t1a=title('Ideal (Real)');
set(gca,'FontSize',10,'FontWeight','bold')
subplot(2,2,2),bar3(imag(outdm_th));
t2a=title('Ideal (Imag)');
set(gca,'FontSize',10,'FontWeight','bold')

subplot(2,2,3),bar3(real(outdm_sim));
t1=title('Simu. (Real)');
set(gca,'FontSize',10,'FontWeight','bold')
subplot(2,2,4),bar3(imag(outdm_sim));
t2=title('Sim. (Imag)');
set(gca,'FontSize',10,'FontWeight','bold')
set([t1 t1a t2 t2a],'FontSize',12,'FontWeight','bold')


##### SOURCE END #####
--></body></html>