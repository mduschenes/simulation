
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>Filename : smoothGRAPE</title>
      <meta name="generator" content="MATLAB 7.14">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2014-03-05">
      <meta name="DC.source" content="smoothGRAPE.m">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <link rel="stylesheet" type="text/css" href="../css/screen.css" media="screen" />
  </head>
  
<body>
    <ul id=menu>
      <li><a href="../flowchart.html">Flow Chart</a>
      <li><a href="../tools/tools.html">Tools</a>
      <li><a href="../faq/faq.html">F. A. Q.</a>
      <li><a href="../../index.html">NMR-QIP Page</a>
    </ul>
    
    <div class="content"><h1>FileName : smoothGRAPE</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#2">Command</a></li><li><a href="#3">Example Output</a></li></ul></div><h2>Description<a name="1"></a></h2><p>Smoothens the GRAPE pulse by decreasing the del_t (which increases the N) and interpolating the original values using the matlab inbuilt function spline.</p><h2>Command<a name="2"></a></h2><p><b>new_u=smoothGRAPE(GRinfo,n)</b></p><p><b>GRinfo</b> : Variable in which all the information of grape pulse is stored.</p><p><b>n</b> : Represents the number of time you want to divide del_t in, del_t is the time for each division in the GRAPE pulse</p><p><b>new_u</b> : it is the output in which your new added controls be saved.</p><h2>Example Output<a name="3"></a></h2><p>Shown below is an example plot. THe pulse is a 90x on all the spins acted upon the thermal equilibrium state.</p><p><img vspace="5" hspace="5" src="../tools/img/sample_smoothGRAPE.jpg" alt=""> </p><pre class="codeinput"><span class="keyword">function</span> u_smooth = smoothGRAPE(GRinfo,n)
<span class="keyword">global</span> gra
gra = GRinfo;

del_t = gra.del_t*1e6;

<span class="keyword">for</span> j=1:gra.m
    x=1:del_t:del_t*gra.N;
    y=gra.u(:,j);
    xx =1:del_t/n:del_t*gra.N;
    u_smooth(:,j) = spline(x,y,xx);
<span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% FileName : smoothGRAPE

%% Description
% Smoothens the GRAPE pulse by decreasing the del_t (which increases the N)
% and interpolating the original values using the matlab inbuilt function
% spline.

%% Command
% *new_u=smoothGRAPE(GRinfo,n)*
%
% *GRinfo* : Variable in which all the information of grape pulse is stored.
%
% *n* : Represents the number of time you want to divide del_t in, del_t is the time for each division in the GRAPE pulse
%
% *new_u* : it is the output in which your new added controls be saved.
%

%% Example Output
% Shown below is an example plot. THe pulse is a 90x on all the spins acted
% upon the thermal equilibrium state.
%
% <<sample_smoothGRAPE.jpg>>

function u_smooth = smoothGRAPE(GRinfo,n)

if nargin < 1
    disp('  ')
    disp('      u_new = smoothGRAPE(GRinfo,del_t,n)')
    disp('      Calculates  a smooth pulse sequence by interpolating the graph usinh spline')
    disp('  ')
    disp('               del_t - for example 10e-6')
    disp('                          n - number of points you want to divide del_t in. ')
    disp('  ')
    disp('      SIMPLEST INPUT : u_new = smoothGRAPE(GRinfo,del_t,n)')
    disp('')
    disp('  ')
    disp('   (Hemant Katiyar, 2012)')
    return
end

global gra
gra = GRinfo;

del_t = gra.del_t*1e6;

for j=1:gra.m
    x=1:del_t:del_t*gra.N;
    y=gra.u(:,j);
    xx =1:del_t/n:del_t*gra.N;
    u_smooth(:,j) = spline(x,y,xx);
end

##### SOURCE END #####
--></body></html>