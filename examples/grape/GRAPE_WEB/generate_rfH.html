
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>  
  <head>
      <title>Filename : generate_rfH</title>
      <meta name="generator" content="MATLAB 7.14">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2014-03-05">
      <meta name="DC.source" content="generate_rfH.m">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <link rel="stylesheet" type="text/css" href="css/screen.css" media="screen" />
  </head>
  
  
  <body>
    <ul id=menu>
      <li><a href="flowchart.html">Flow Chart</a>
      <li><a href="tools/tools.html">Tools</a>
      <li><a href="faq/faq.html">F. A. Q.</a>
      <li><a href="../index.html">NMR-QIP Page</a>
    </ul>
<div class="content"><h1>FileName : generate_free_evolH</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li></ul></div><h2>Description<a name="1"></a></h2><p>This program calculates the Radiofrequency hamiltonian. Hrf, is a 1xN cell where N is twice the number of channel or the number of hetronuclear nuclei.</p><p>Each cell consists of a matrix as described below :</p><div><ul><li>First N/2 matrices are <img src="Images/generate_rfH_eq87510.png" alt="$\sum I_x$"> where sum is over each nuclear species present</li><li>Last N/2 matrices are <img src="Images/generate_rfH_eq44316.png" alt="$\sum I_y$"> where sum is over each nuclear species present</li></ul></div><pre class="codeinput"><span class="keyword">function</span> [H_rf] = generate_rfH(spinlist)
<span class="keyword">global</span> gra

Ix=gra.Ix; Iy=gra.Iy; Iz=gra.Iz;

<span class="keyword">if</span>(length(spinlist)&lt;2)
    n(1)=0;
<span class="keyword">else</span>
    n(1)=0;
    n(2:length(spinlist))=spinlist(1:length(spinlist)-1);
<span class="keyword">end</span>

<span class="keyword">for</span> k=1:length(spinlist)
    H_rf{1,k}=zeros(2^sum(spinlist));
    H_rf{1,k+length(spinlist)}=zeros(2^sum(spinlist));
    <span class="keyword">for</span> j=n(k)+1:n(k)+spinlist(k)
        H_rf{1,k}   = H_rf{1,k}+Ix(:,:,j);
        H_rf{1,k+length(spinlist)} = H_rf{1,k+length(spinlist)}+Iy(:,:,j);
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% FileName : generate_free_evolH

%% Description
% This program calculates the Radiofrequency hamiltonian.
% Hrf, is a 1xN cell where N is twice the number of channel or the
% number of hetronuclear nuclei.
%
% Each cell consists of a matrix as described below :
%
% * First N/2 matrices are $\sum I_x$ where sum is over each nuclear species present
% * Last N/2 matrices are $\sum I_y$ where sum is over each nuclear species present

function [H_rf] = generate_rfH(spinlist)
global gra

Ix=gra.Ix; Iy=gra.Iy; Iz=gra.Iz;

if(length(spinlist)<2)
    n(1)=0;
else
    n(1)=0;
    n(2:length(spinlist))=spinlist(1:length(spinlist)-1);
end

for k=1:length(spinlist)
    H_rf{1,k}=zeros(2^sum(spinlist));
    H_rf{1,k+length(spinlist)}=zeros(2^sum(spinlist)); 
    for j=n(k)+1:n(k)+spinlist(k)
        H_rf{1,k}   = H_rf{1,k}+Ix(:,:,j);
        H_rf{1,k+length(spinlist)} = H_rf{1,k+length(spinlist)}+Iy(:,:,j);
    end
end
##### SOURCE END #####
--></body></html>