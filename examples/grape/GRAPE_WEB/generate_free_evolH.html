
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
      <title>Filename : generate_free_evolH</title>
      <meta name="generator" content="MATLAB 7.14">
      <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
      <meta name="DC.date" content="2014-03-05">
      <meta name="DC.source" content="generate_free_evolH.m">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <link rel="stylesheet" type="text/css" href="css/screen.css" media="screen" />
  </head>
  
  
  
  
  
  <body>
    <ul id=menu>
      <li><a href="flowchart.html">Flow Chart</a>
      <li><a href="tools/tools.html">Tools</a>
      <li><a href="faq/faq.html">F. A. Q.</a>
      <li><a href="../index.html">NMR-QIP Page</a>
    </ul>
    <div class="content"><h1>FileName : generate_free_evolH</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Description</a></li><li><a href="#3">Generating Zeeman Hamiltonian</a></li><li><a href="#4">Generating J-coupling Hamiltonian</a></li><li><a href="#5">Total Internal Hamiltonian</a></li></ul></div><h2>Description<a name="1"></a></h2><p>This program calculates the Free Evolution hamiltonian or the Hamiltonian in absence of Radio Frequency Pulse</p><pre class="codeinput"><span class="keyword">function</span> [H_free_evo] = generate_free_evolH(spinlist,v,J)
</pre><pre class="codeinput"><span class="keyword">global</span> gra
Ix=gra.Ix; Iy=gra.Iy; Iz=gra.Iz;
</pre><h2>Generating Zeeman Hamiltonian<a name="3"></a></h2><p>We are generating <img src="Images/generate_free_evolH_eq04748.png" alt="$Ho = -\sum_i 2\pi v_i I_z^i$"></p><pre class="codeinput">Ho=zeros(2^sum(spinlist));
<span class="keyword">for</span> k=1:length(v)
    H_off = -2*pi*v(k)*Iz(:,:,k);
    Ho=Ho+H_off;
<span class="keyword">end</span>
</pre><h2>Generating J-coupling Hamiltonian<a name="4"></a></h2><p>We are generating <img src="Images/generate_free_evolH_eq41034.png" alt="$Hj = \sum_{ij}^{j&gt;i} 2\pi J (I_x^i I_x^j + I_y^i I_y^j + I_z^i I_z^j)$"></p><pre class="codeinput">Hj=zeros(2^sum(spinlist));
<span class="keyword">for</span> j=1:length(spinlist)
    spinlistsum(j)=sum(spinlist(1:j));
<span class="keyword">end</span>

<span class="keyword">for</span> l=1:length(spinlist)
    <span class="keyword">if</span>(l==1)
        <span class="keyword">for</span> k=1:spinlist(l)
            <span class="keyword">for</span> n=1:spinlist(l)
                H_coup = 2*pi*J(k,n)*(Ix(:,:,k)*Ix(:,:,n) + Iy(:,:,k)*Iy(:,:,n) + Iz(:,:,k)*Iz(:,:,n));
                Hj=Hj+H_coup;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">else</span>
        <span class="keyword">for</span> k=spinlist(l-1)+1:spinlistsum(l)
            <span class="keyword">for</span> n=spinlist(l-1)+1:spinlistsum(l)
                H_coup = 2*pi*J(k,n)*(Ix(:,:,k)*Ix(:,:,n) + Iy(:,:,k)*Iy(:,:,n) + Iz(:,:,k)*Iz(:,:,n));
                Hj=Hj+H_coup;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2>Total Internal Hamiltonian<a name="5"></a></h2><pre class="codeinput">H_free_evo=Ho+Hj;
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% FileName : generate_free_evolH

%% Description
%
% This program calculates the Free Evolution hamiltonian or the Hamiltonian
% in absence of Radio Frequency Pulse

function [H_free_evo] = generate_free_evolH(spinlist,v,J)
global gra
Ix=gra.Ix; Iy=gra.Iy; Iz=gra.Iz;


%% Generating Zeeman Hamiltonian
% We are generating $Ho = -\sum_i 2\pi v_i I_z^i$
Ho=zeros(2^sum(spinlist));
for k=1:length(v)
    H_off = -2*pi*v(k)*Iz(:,:,k);
    Ho=Ho+H_off;
end

%% Generating J-coupling Hamiltonian
% We are generating $Hj = \sum_{ij}^{j>i} 2\pi J (I_x^i I_x^j + I_y^i I_y^j + I_z^i I_z^j)$
Hj=zeros(2^sum(spinlist));
for j=1:length(spinlist)
    spinlistsum(j)=sum(spinlist(1:j));
end

for l=1:length(spinlist)
    if(l==1)
        for k=1:spinlist(l)
            for n=1:spinlist(l)
                H_coup = 2*pi*J(k,n)*(Ix(:,:,k)*Ix(:,:,n) + Iy(:,:,k)*Iy(:,:,n) + Iz(:,:,k)*Iz(:,:,n));
                Hj=Hj+H_coup;
            end
        end
    else
        for k=spinlist(l-1)+1:spinlistsum(l)
            for n=spinlist(l-1)+1:spinlistsum(l)
                H_coup = 2*pi*J(k,n)*(Ix(:,:,k)*Ix(:,:,n) + Iy(:,:,k)*Iy(:,:,n) + Iz(:,:,k)*Iz(:,:,n));
                Hj=Hj+H_coup;
            end
        end
    end
end

%% Total Internal Hamiltonian

H_free_evo=Ho+Hj;



##### SOURCE END #####
--></body></html>